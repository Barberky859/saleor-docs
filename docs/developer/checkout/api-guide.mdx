---
title: Checkout API Guide
sidebar_label: API Guide
hide_table_of_contents: true
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import TwoColumn from "@site/components/Layout";

## Creating a Checkout Session

<TwoColumn>
<div>
A [`Checkout`](/api-reference/checkout/objects/checkout.mdx) object can be created for logged-in users and for anonymous (guest) users.

To create a [`Checkout`](api-reference/checkout/objects/checkout.mdx) object, use the [`checkoutCreate`](api-reference/checkout/mutations/checkout-create.mdx) mutation.

- if [Authorization header](/api-usage/authentication.mdx) with a valid auth token is provided, the created checkout will be assigned to the user who is authenticated by this token.

- If no authentication token is provided, the checkout is created for an anonymous user,
  and an email address is used to identify such a [`Checkout`](api-reference/checkout/objects/checkout.mdx) object,
  linking it with the **anonymous user**.
  User email is not required at this stage but must be provided before adding a promo code, creating a payment or completing checkout.
</div>

<Tabs>
<TabItem value="GraphQL">
```graphql
mutation {
  checkoutCreate(
    input: {
      channel: "default-channel"
      email: "customer@example.com"
      lines: [{ quantity: 1, variantId: "UHJvZHVjdFZhcmlhbnQ6Mjk3" }]
      shippingAddress: {
        firstName: "John"
        lastName: "Doe"
        streetAddress1: "1470  Pinewood Avenue"
        city: "Michigan"
        postalCode: "49855"
        country: US
        countryArea: "MI"
      }
      billingAddress: {
        firstName: "John"
        lastName: "Doe"
        streetAddress1: "1470  Pinewood Avenue"
        city: "Michigan"
        postalCode: "49855"
        country: US
        countryArea: "MI"
      }
    }
  ) {
    checkout {
      id
      totalPrice {
        gross {
          amount
          currency
        }
      }
      isShippingRequired
      shippingMethods {
        id
        name
        active
        message
      }
      availableCollectionPoints {
        id
        name
        clickAndCollectOption
      }
      availablePaymentGateways {
        id
        name
        config {
          field
          value
        }
      }
    }
    errors {
      field
      code
    }
  }
}
```
    </TabItem>
<TabItem value={"Result"}>
```json
{
  "data": {
    "checkoutCreate": {
      "checkout": {
        "id": "Q2hlY2tvdXQ6ZmE5ZjBkMjYtMWM3NC00MDgyLTk3MzktYTIxOGE2NzVjMDZk",
        "totalPrice": {
          "gross": {
            "amount": 20,
            "currency": "USD"
          }
        },
        "isShippingRequired": true,
        "shippingMethods": [
          {
            "id": "U2hpcHBpbmdNZXRob2Q6MTM=",
            "name": "UPS",
            "active": true,
            "message": ""
          },
          {
            "id": "U2hpcHBpbmdNZXRob2Q6MTI=",
            "name": "DHL",
            "active": false,
            "message": "Not available."
          }
        ],
        "availableCollectionPoints": [
          {
            "id": "V2FyZWhvdXNlOjU0NjliNWQ3LThmOGUtNGVmOS1iMGQxLWNhYWZmYTg4MjI1OQ==",
            "name": "Local Store"
            "clickAndCollectOption": "LOCAL"
          },
          {
            "id": "=V2FyZWhvdXNlOjU0NjliNWQ3LThmOGUtNGVmOS1iMGQxLWNhYWZmYTg4MjI1OA==",
            "name": "Company HQ"
            "clickAndCollectOption": "ALL"
          }
        ],
        "availablePaymentGateways": [
          {
            "id": "app.saleor.adyen",
            "name": "Adyen",
            "config": []
          }
        ]
      },
      "errors": []
    }
  }
}
```
    </TabItem>
</Tabs>
</TwoColumn>

## Set Email

<TwoColumn>
<div>
When an anonymous checkout has been created without an email, the email must be set using [`CheckoutEmailUpdate`](api-reference/checkout/mutations/checkout-email-update.mdx) before creating payment and completing the checkout.
</div>

<Tabs>
<TabItem value={"GraphQL"}>
```graphql {2-4}
mutation {
  checkoutEmailUpdate(
    id: "Q2hlY2tvdXQ6ZTEzZDFjOTItOWJkNi00ODViLTgyMDctZTNhM2I5NjVkZTQw"
    email: "test_customer@example.com"
  ) {
    checkout {
      id
      email
    }
    errors {
      field
      message
    }
  }
}
```
</TabItem>
<TabItem value={"Result"}>

```json {6}
{
  "data": {
    "checkoutDeliveryMethodUpdate": {
      "checkout": {
        "id": "Q2hlY2tvdXQ6ZTEzZDFjOTItOWJkNi00ODViLTgyMDctZTNhM2I5NjVkZTQw",
        "email": "test_customer@example.com"
      },
      "errors": []
    }
  }
}
```

</TabItem>
</Tabs>
</TwoColumn>
